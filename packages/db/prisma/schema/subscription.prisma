enum PlanType {
  FREE
  PERSONAL
  PRO
}

enum SubscriptionStatus {
  ACTIVE
  CANCELED
  PAST_DUE
  INCOMPLETE
  INCOMPLETE_EXPIRED
  TRIALING
  UNPAID
}

model Subscription {
  id        String   @id @default(uuid())
  userId    String   @unique
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  planType  PlanType @default(FREE)
  status    SubscriptionStatus @default(ACTIVE)
  polarSubscriptionId String? // ID de l'abonnement Polar
  polarCustomerId   String? // ID du client Polar
  currentPeriodStart DateTime?
  currentPeriodEnd   DateTime?
  cancelAtPeriodEnd  Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
  @@index([planType])
  @@index([status])
  @@index([polarSubscriptionId]) // Fast lookups for webhook updates
  @@map("subscription")
}

