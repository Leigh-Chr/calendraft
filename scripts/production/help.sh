#!/bin/bash
# Aide pour les scripts de production
# Usage: ./help.sh [script]

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

show_help() {
    local script="$1"
    
    case "$script" in
        deploy)
            echo "üöÄ Script de D√©ploiement"
            echo "========================="
            echo ""
            echo "Usage: ./deploy.sh [options]"
            echo ""
            echo "Options:"
            echo "  --backup          Cr√©er une sauvegarde avant le d√©ploiement"
            echo "  --migrate         Appliquer les migrations de base de donn√©es"
            echo "  --service=SERVICE D√©ployer uniquement un service (web, server, etc.)"
            echo ""
            echo "Exemples:"
            echo "  ./deploy.sh"
            echo "  ./deploy.sh --backup"
            echo "  ./deploy.sh --backup --migrate"
            echo "  ./deploy.sh --service=web"
            ;;
        backup)
            echo "üíæ Script de Sauvegarde"
            echo "======================="
            echo ""
            echo "Usage: ./backup.sh [options]"
            echo ""
            echo "Options:"
            echo "  --list                    Lister les sauvegardes disponibles"
            echo "  --restore=FICHIER         Restaurer une sauvegarde"
            echo ""
            echo "Exemples:"
            echo "  ./backup.sh"
            echo "  ./backup.sh --list"
            echo "  ./backup.sh --restore=~/backups/db-backup-20251213-120000.sql.gz"
            ;;
        monitor)
            echo "üìä Script de Monitoring"
            echo "======================"
            echo ""
            echo "Usage: ./monitor.sh [options]"
            echo ""
            echo "Options:"
            echo "  --all      Afficher toutes les informations"
            echo "  --health   Afficher l'√©tat de sant√©"
            echo "  --stats    Afficher les statistiques de ressources"
            echo "  --logs     Afficher les logs r√©cents"
            echo "  --errors   Afficher les erreurs r√©centes"
            echo ""
            echo "Exemples:"
            echo "  ./monitor.sh --all"
            echo "  ./monitor.sh --health"
            echo "  ./monitor.sh --stats"
            ;;
        health-check)
            echo "üè• Script de V√©rification de Sant√©"
            echo "==================================="
            echo ""
            echo "Usage: ./health-check.sh [options]"
            echo ""
            echo "Options:"
            echo "  --verbose  Afficher les d√©tails des v√©rifications"
            echo ""
            echo "Exemples:"
            echo "  ./health-check.sh"
            echo "  ./health-check.sh --verbose"
            ;;
        cleanup)
            echo "üßπ Script de Nettoyage"
            echo "======================"
            echo ""
            echo "Usage: ./cleanup.sh [options]"
            echo ""
            echo "Options:"
            echo "  --all          Nettoyer images, cache et logs"
            echo "  --images       Nettoyer les images inutilis√©es"
            echo "  --volumes      Nettoyer les volumes inutilis√©s (‚ö†Ô∏è  destructif)"
            echo "  --logs         Nettoyer les logs"
            echo "  --system       Nettoyage complet du syst√®me (‚ö†Ô∏è  tr√®s destructif)"
            echo "  --build-cache  Nettoyer le cache de build"
            echo ""
            echo "Exemples:"
            echo "  ./cleanup.sh --all"
            echo "  ./cleanup.sh --images"
            echo "  ./cleanup.sh --build-cache"
            ;;
        quick-commands)
            echo "‚ö° Commandes Rapides"
            echo "===================="
            echo ""
            echo "Usage: ./quick-commands.sh [command] [service]"
            echo ""
            echo "Commandes:"
            echo "  status, ps          Statut des services"
            echo "  logs [service]      Logs en temps r√©el"
            echo "  restart [service]   Red√©marrer"
            echo "  stop [service]      Arr√™ter"
            echo "  start [service]     D√©marrer"
            echo "  shell-db            Shell PostgreSQL"
            echo "  shell-server        Shell backend"
            echo "  shell-web           Shell frontend"
            echo "  stats               Statistiques"
            echo "  top                 Processus"
            echo "  env                 Configuration"
            echo ""
            echo "Exemples:"
            echo "  ./quick-commands.sh status"
            echo "  ./quick-commands.sh logs server"
            echo "  ./quick-commands.sh restart web"
            ;;
        rollback)
            echo "üîÑ Script de Rollback"
            echo "====================="
            echo ""
            echo "Usage: ./rollback.sh [options]"
            echo ""
            echo "Options:"
            echo "  --commit=HASH       Commit sp√©cifique (sinon demande)"
            echo "  --no-backup         Ne pas cr√©er de sauvegarde avant rollback"
            echo "  --no-db             Ne pas restaurer la base de donn√©es"
            echo ""
            echo "Exemples:"
            echo "  ./rollback.sh"
            echo "  ./rollback.sh --commit=abc123"
            echo "  ./rollback.sh --commit=HEAD~1 --no-backup"
            ;;
        verify-backup)
            echo "üîç V√©rification de Sauvegarde"
            echo "============================="
            echo ""
            echo "Usage: ./verify-backup.sh [FILE]"
            echo ""
            echo "Si FILE est fourni, v√©rifie ce fichier sp√©cifique."
            echo "Sinon, v√©rifie toutes les sauvegardes dans BACKUP_DIR."
            echo ""
            echo "Exemples:"
            echo "  ./verify-backup.sh"
            echo "  ./verify-backup.sh ~/backups/db-backup-20251213.sql.gz"
            ;;
        security-audit)
            echo "üîí Audit de S√©curit√©"
            echo "==================="
            echo ""
            echo "Usage: ./security-audit.sh [options]"
            echo ""
            echo "Options:"
            echo "  --verbose           Afficher les d√©tails des v√©rifications"
            echo ""
            echo "V√©rifie:"
            echo "  - Certificats SSL"
            echo "  - Headers de s√©curit√©"
            echo "  - Variables d'environnement"
            echo "  - Configuration Docker"
            echo "  - Exposition des ports"
            echo ""
            echo "Exemples:"
            echo "  ./security-audit.sh"
            echo "  ./security-audit.sh --verbose"
            ;;
        report)
            echo "üìä Rapport d'√âtat"
            echo "================"
            echo ""
            echo "Usage: ./report.sh [options]"
            echo ""
            echo "Options:"
            echo "  --format=text|json  Format du rapport (d√©faut: text)"
            echo "  --output=FILE        Fichier de sortie (d√©faut: stdout)"
            echo ""
            echo "Exemples:"
            echo "  ./report.sh"
            echo "  ./report.sh --format=json --output=report.json"
            echo "  ./report.sh --format=text --output=report.txt"
            ;;
        install)
            echo "üì¶ Script d'Installation"
            echo "========================"
            echo ""
            echo "Usage: ./install.sh user@server"
            echo ""
            echo "Installe tous les scripts de production sur un serveur distant."
            echo ""
            echo "Exemples:"
            echo "  ./install.sh root@185.158.132.190"
            echo "  ./install.sh user@example.com"
            echo ""
            echo "Le script copie:"
            echo "  - Tous les scripts .sh dans ~/calendraft/scripts/production/"
            echo "  - PRODUCTION_COMMANDS.md dans ~/calendraft/"
            ;;
        *)
            echo "üìö Aide - Scripts de Production Calendraft"
            echo "=========================================="
            echo ""
            echo "Scripts disponibles:"
            echo ""
            echo "  üöÄ deploy.sh          - D√©ploiement de l'application"
            echo "  üíæ backup.sh          - Sauvegarde et restauration"
            echo "  üîÑ rollback.sh         - Retour √† une version pr√©c√©dente"
            echo "  üìä monitor.sh         - Monitoring et statistiques"
            echo "  üè• health-check.sh     - V√©rification de sant√©"
            echo "  üîí security-audit.sh   - Audit de s√©curit√©"
            echo "  üîç verify-backup.sh    - V√©rification d'int√©grit√© des sauvegardes"
            echo "  üìä report.sh           - Rapport d'√©tat (texte/JSON)"
            echo "  üßπ cleanup.sh         - Nettoyage Docker"
            echo "  ‚ö° quick-commands.sh   - Commandes rapides"
            echo "  üì¶ install.sh         - Installation sur serveur distant"
            echo "  ‚ùì help.sh            - Aide int√©gr√©e (ce script)"
            echo ""
            echo "Usage:"
            echo "  ./help.sh [script]    - Aide pour un script sp√©cifique"
            echo ""
            echo "Exemples:"
            echo "  ./help.sh deploy"
            echo "  ./help.sh backup"
            echo "  ./help.sh rollback"
            echo ""
            echo "Pour plus d'informations, consultez:"
            echo "  ~/calendraft/PRODUCTION_COMMANDS.md"
            echo "  scripts/production/README.md"
            ;;
    esac
}

show_help "${1:-}"

